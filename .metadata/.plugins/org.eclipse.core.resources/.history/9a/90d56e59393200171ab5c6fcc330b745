/* Generated by AN DISI Unibo */ 
/*
This code is generated only ONCE
*/
package it.unibo.myled;
//import it.unibo.bls.raspberry.components.adhoc.DeviceLedPi4jAdHoc;
import it.unibo.myled.LedWithGui;

import java.awt.Panel;
import java.util.ArrayList;
import java.util.List;

import it.unibo.is.interfaces.IOutputEnvView;
import it.unibo.qactors.QActorContext;

public class Myled extends AbstractMyled { 
	
	private List<ILed> ledList;
	private boolean direction;
	private int currentOn;
	
	public Myled(String actorId, QActorContext myCtx, IOutputEnvView outEnvView )  throws Exception{
		super(actorId, myCtx, outEnvView);
		ledList = new ArrayList<ILed>();
		direction=true;
		currentOn=-1;
	}
	
	public void createGuiLed(int pinNum ){
		ILed led = new LedWithGui();		
		outEnvView.getEnv().addPanel((Panel)led);
		ledList.add(led);
	}
	
	public void createPi4jLed(int pinNum ){
		ILed led = new LedWithRasp(pinNum);
		ledList.add(led);
	}
	
	public void changeLedOn(){
		if (currentOn != -1) ledList.get(currentOn).turnOff();
		if (currentOn < ledList.size()-1 && currentOn != 0){
			if (direction) currentOn++;
			else currentOn--;
		}
		else if (currentOn == 0){
				direction = true;
				currentOn++;
		}
		else if (currentOn == ledList.size()-1){
			direction = false;
			currentOn--;
		}
		ledList.get(currentOn).turnOn();
	}
	
	public int getCurrentOn(){
		return currentOn;
	}
	
	public void resetCurrentOn(){
		currentOn= -1;
	}
	
	public void turnOffAll(){
		for (ILed l : ledList){
			l.turnOff();
		}
		this.resetCurrentOn();
	}
	
}